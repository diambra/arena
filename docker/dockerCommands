# Build DIAMBRA docker base image
make image-base

# Build DIAMBRA Arena CPU image
make image

# Build DIAMBRA image with GPU-CUDA10.0 support
make image-cuda-10
# Build DIAMBRA image with GPU-CUDA11.0 support
make image-cuda-11

# Build all images
make images

# Login to Docker 
docker login -u "diambra" -p "XXXXXXXXXXXX" docker.io

# Push docker image to Docker Hub
make push-images

# Run launcher scripts (example)
IMAGE=diambra/diambra-arena:$(git rev-parse --short HEAD) IMAGE_CUDA=diambra/diambra-arena-cuda10:$(git rev-parse --short HEAD) ./diambraArena.sh -d GPU -c "bash"

# Create a container from an image
docker run --rm --privileged --gpus all -it -v pythonDep:/usr/local/lib/python3.6/dist-packages/ -v diambraRoms:/opt/diambraArena/roms --name diambraArena diambra/diambra-arena:main bash
docker run --rm --privileged --gpus all -it --name diambraArena diambra/diambra-arena:main bash

# Create a container with the XORG Gui support
# X11Docker repo: https://github.com/mviereck/x11docker
./x11docker --cap-default --hostipc --network=host --name=diambraArena --wm=host --pulseaudio -- --privileged -- diambra/diambra-arena:main &>/dev/null & sleep 4s; docker exec -u 0 --privileged -it diambraArena /bin/bash -c "cd /opt/diambraArena/; bash"

# Access a running container
docker exec -u 0 --privileged -it diambraArena bash

# Copy folder from local FS to docker container (the latter should be in execution)
docker cp ../roms/mame/. diambraArena:/opt/diambraArena/roms/

# Save docker local image to tarball
docker save -o tarball.tar diambra/diambra-arena:main

# Load docker image from tarball into local images
docker load -i tarball.tar

